$ git clone git@github.com:docker-hy/scaling-exercise.git
Cloning into 'scaling-exercise'...
remote: Enumerating objects: 26, done.
remote: Counting objects: 100% (26/26), done.
remote: Compressing objects: 100% (20/20), done.
remote: Total 26 (delta 2), reused 26 (delta 2), pack-reused 0
Receiving objects: 100% (26/26), 85.55 KiB | 0 bytes/s, done.
Resolving deltas: 100% (2/2), done.
$ cd scaling-exercise/
$ docker-compose up --scale compute=2
Creating network "scaling-exercise_default" with the default driver
Building calculator
Step 1/6 : FROM node
latest: Pulling from library/node
a4d8138d0f6b: Pull complete
dbdc36973392: Pull complete
f59d6d019dd5: Pull complete
aaef3e026258: Pull complete
6e454d3b6c28: Pull complete
c717a7c205aa: Pull complete
e8566b4564fe: Pull complete
04239395be03: Pull complete
27ace7d95321: Pull complete
Digest: sha256:6e64f63a663a368cc81b28ed3c3e29e6b3784c04f0128be5aaa659157ed4d231
Status: Downloaded newer image for node:latest
 ---> 7c412a558705
Step 2/6 : WORKDIR /usr/app
 ---> Running in c43f9b2d76cb
Removing intermediate container c43f9b2d76cb
 ---> 91b116fd7325
Step 3/6 : COPY . .
 ---> 2602ba843129
Step 4/6 : RUN npm ci && npm run build
 ---> Running in 7eee97d394c8

> fsevents@1.2.7 install /usr/app/node_modules/fsevents
> node install

added 865 packages in 11.101s

> calc@1.0.0 build /usr/app
> webpack --mode production

Hash: 416b9087278dbed915c2
Version: webpack 4.29.6
Time: 12818ms
Built at: 07/14/2019 7:49:26 PM
                                 Asset       Size  Chunks                    Chunk Names
0ab54153eeeca0ce03978cc463b257f7.woff2   39.2 KiB          [emitted]         
  13db00b7a34fee4d819ab7f9838cc428.eot   96.3 KiB          [emitted]         
  701ae6abd4719e9c2ada3535a497b341.eot   30.4 KiB          [emitted]         
  82f60bd0b94a1ed68b1e6e309ce2e8c3.svg    105 KiB          [emitted]         
  8e3c7f5520f5ae906c6cf6d7f3ddcd19.eot    104 KiB          [emitted]         
  962a1bf31c081691065fe333d9fa8105.svg    382 KiB          [emitted]  [big]  
  9c74e172f87984c48ddf5c8108cabe67.png   27.5 KiB          [emitted]         
 a046592bac8f2fd96e994733faf3858c.woff   62.2 KiB          [emitted]         
  a1a749e89f578a49306ec2b055c073da.svg    496 KiB          [emitted]  [big]  
  ad97afd3337e8cda302d10ff5a4026b8.ttf   30.2 KiB          [emitted]         
  b87b9ba532ace76ae9f6edfe9f72ded2.ttf    103 KiB          [emitted]         
  c5ebe0b32dc1b5cc449a76c4204d13bb.ttf   96.1 KiB          [emitted]         
cd6c777f1945164224dee082abaea03a.woff2     12 KiB          [emitted]         
e8c322de9658cbeb8a774b6624167c2c.woff2   53.2 KiB          [emitted]         
 ef60a4f6c25ef7f39f2d25a748dbecfe.woff   14.4 KiB          [emitted]         
 faff92145777a3cbaf8e7367b4807987.woff   49.3 KiB          [emitted]         
                            index.html  612 bytes          [emitted]         
                              main.css    614 KiB       0  [emitted]  [big]  main
                               main.js    301 KiB       0  [emitted]  [big]  main
Entrypoint main [big] = main.css main.js
[196] (webpack)/buildin/global.js 472 bytes {0} [built]
[212] (webpack)/buildin/module.js 497 bytes {0} [built]
[244] multi @babel/polyfill ./src 40 bytes {0} [built]
[574] ./src/index.js + 39 modules 147 KiB {0} [built]
      | ./src/index.js 318 bytes [built]
      | ./src/commons.js 1.66 KiB [built]
      |     + 38 hidden modules
    + 951 hidden modules

WARNING in asset size limit: The following asset(s) exceed the recommended size limit (244 KiB).
This can impact web performance.
Assets: 
  962a1bf31c081691065fe333d9fa8105.svg (382 KiB)
  a1a749e89f578a49306ec2b055c073da.svg (496 KiB)
  main.css (614 KiB)
  main.js (301 KiB)

WARNING in entrypoint size limit: The following entrypoint(s) combined asset size exceeds the recommended limit (244 KiB). This can impact web performance.
Entrypoints:
  main (914 KiB)
      main.css
      main.js


WARNING in webpack performance recommendations: 
You can limit the size of your bundles by using import() or require.ensure to lazy load some parts of your application.
For more info visit https://webpack.js.org/guides/code-splitting/
Child html-webpack-plugin for "index.html":
     1 asset
    Entrypoint undefined = index.html
    [0] ./node_modules/html-webpack-plugin/lib/loader.js!./src/index.html 737 bytes {0} [built]
    [2] (webpack)/buildin/global.js 472 bytes {0} [built]
    [3] (webpack)/buildin/module.js 497 bytes {0} [built]
        + 1 hidden module
Child mini-css-extract-plugin node_modules/css-loader/dist/cjs.js!node_modules/semantic-ui-css/semantic.min.css:
    Entrypoint mini-css-extract-plugin = *
       19 modules
Removing intermediate container 7eee97d394c8
 ---> 7e3497a0aad6
Step 5/6 : EXPOSE 3000
 ---> Running in 353fa745ffb1
Removing intermediate container 353fa745ffb1
 ---> b3a4e5e4da92
Step 6/6 : CMD ["npm", "start"]
 ---> Running in d46258d292f2
Removing intermediate container d46258d292f2
 ---> c8c727caa741
Successfully built c8c727caa741
Successfully tagged calculator:latest
WARNING: Image for service calculator was built because it did not already exist. To rebuild this image you must use `docker-compose build` or `docker-compose up --build`.
Building compute
Step 1/6 : FROM node
 ---> 7c412a558705
Step 2/6 : WORKDIR /usr/app
 ---> Using cache
 ---> 91b116fd7325
Step 3/6 : COPY . .
 ---> 00c89a55728b
Step 4/6 : RUN npm ci
 ---> Running in d93ecbde1401

> fsevents@1.2.7 install /usr/app/node_modules/fsevents
> node install


> nodemon@1.18.10 postinstall /usr/app/node_modules/nodemon
> node bin/postinstall || exit 0

Love nodemon? You can now support the project via the open collective:
 > https://opencollective.com/nodemon/donate

added 269 packages in 3.674s
Removing intermediate container d93ecbde1401
 ---> d4e0fcd70975
Step 5/6 : EXPOSE 3000
 ---> Running in e6d5d35b196f
Removing intermediate container e6d5d35b196f
 ---> f9bede06b2ee
Step 6/6 : CMD ["node", "./index.js"]
 ---> Running in 2ad28afbdb52
Removing intermediate container 2ad28afbdb52
 ---> 6efa3f47797d
Successfully built 6efa3f47797d
Successfully tagged compute:latest
WARNING: Image for service compute was built because it did not already exist. To rebuild this image you must use `docker-compose build` or `docker-compose up --build`.
Building load-balancer
Step 1/2 : FROM jwilder/nginx-proxy
latest: Pulling from jwilder/nginx-proxy
a5a6f2f73cd8: Pull complete
2343eb083a4e: Pull complete
251439d5b33c: Pull complete
4433e13a0da0: Pull complete
037c27f985e2: Pull complete
e7452fe15384: Pull complete
fd612ac93175: Pull complete
f34233958ad5: Pull complete
52e2020e6191: Pull complete
b14694bcc1a3: Pull complete
Digest: sha256:a5b4824bcd37f8457624f1f345674cc921a9feadd572c2c45ee261df005b7209
Status: Downloaded newer image for jwilder/nginx-proxy:latest
 ---> 46fc9150cb48
Step 2/2 : EXPOSE 80
 ---> Running in 2256bb9f2a72
Removing intermediate container 2256bb9f2a72
 ---> 579edbf8e306
Successfully built 579edbf8e306
Successfully tagged load-balancer:latest
WARNING: Image for service load-balancer was built because it did not already exist. To rebuild this image you must use `docker-compose build` or `docker-compose up --build`.
Creating scaling-exercise_compute_1 ... done
Creating scaling-exercise_compute_2 ... done
Creating calculator                 ... done
Creating load-balancer              ... done
Attaching to scaling-exercise_compute_1, scaling-exercise_compute_2, load-balancer, calculator
compute_1        | I just connected on port 3000!
compute_2        | I just connected on port 3000!
load-balancer    | WARNING: /etc/nginx/dhparam/dhparam.pem was not found. A pre-generated dhparam.pem will be used for now while a new one
load-balancer    | is being generated in the background.  Once the new dhparam.pem is in place, nginx will be reloaded.
load-balancer    | forego     | starting dockergen.1 on port 5000
load-balancer    | forego     | starting nginx.1 on port 5100
load-balancer    | dockergen.1 | 2019/07/14 19:49:55 Generated '/etc/nginx/conf.d/default.conf' from 4 containers
load-balancer    | dockergen.1 | 2019/07/14 19:49:55 Watching docker events
load-balancer    | dockergen.1 | 2019/07/14 19:49:55 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'
calculator       | 
calculator       | > calc@1.0.0 start /usr/app
calculator       | > serve -s -l 3000 dist
calculator       | 
calculator       | UPDATE AVAILABLE The latest version of `serve` is 11.1.0
calculator       | INFO: Accepting connections at http://localhost:3000
##### From another window
$ firefox http://localhost:3000 &
#####
Gracefully stopping... (press Ctrl+C again to force)
Killing load-balancer               ... done
Killing calculator                  ... done
Killing scaling-exercise_compute_1  ... done
Killing scaling-exercise_compute_2  ... done
$
